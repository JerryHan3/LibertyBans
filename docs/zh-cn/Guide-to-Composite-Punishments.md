
组合式处罚，即一个同时对UUID和IP地址生效的处罚。组合式处罚是一个高级概念，因此您应当在使用它之前确保您理解它的机制。

### 术语

为方便起见，本页面将使用术语"组合式封禁"。不过，您也可以用相同的方式进行其他组合式处罚，如禁言、警告、踢出等。

您应当熟悉UUID和IP地址的概念，它们与玩家之间的关联，以及它们发生改变的情形。

## 定义

* 用户封禁对一个UUID生效。
* IP封禁对一个IP地址生效。
* 组合式封禁同时对一个UUID和一个IP地址生效。

### 功能

对于执行处罚的方式，组合式封禁与IP封禁很相似。
* 在"宽容"等级下，组合式封禁会封禁所有使用被封UUID和被封IP地址的用户。
  * "宽容"等级的IP封禁只会封禁使用该IP地址的用户，而"普通"等级的IP封禁会封禁所有用过该IP地址的用户。因此，如果您希望执行一个比"宽容"等级IP封禁更严格、但又没"普通"等级IP封禁严格的处罚，组合式封禁就会比较有用。
* 在"普通"、"严厉"、或"严苛"等级下，组合式封禁的行为与IP封禁的行为相同。
  * 这是因为在这三种等级下，IP封禁总是会对用过那个IP的用户生效，所以可以看作那个用户的UUID也被封禁了。
  * 还请回顾[处罚的执行机制](Punishment-Enforcement_-Lenient,-Normal,-and-Strict-settings)。

对于用命令执行、撤销、列出处罚记录的操作，显然组合式封禁比IP封禁更好用。
  * 在封禁记录中，显示的不是IP地址，而是被封禁玩家的名称。
  * 如果您在配置里启用了`composite-by-default`选项：
    * `/ban Player1` 将创建一个组合式封禁。
    * `/unban Player1` 将撤销一个组合式封禁。
  * 由于组合式封禁也会对玩家生效，当使用/history、/warns等列表命令查询该玩家的被处罚记录是，这些记录也会显示出来。

### 注意事项

正常来讲，不可能再次封禁或禁言一个已被封禁或禁言的UUID或IP地址。如果您封禁了Player1，并且您尝试再次封禁Player1，LibertyBans会告诉您该玩家已经被封禁了。

* 但是，对UUID相同、但IP地址不同的玩家执行组合式封禁的操作是可行的。
* 同样地，也可以对UUID不同但IP地址相同的玩家执行组合式封禁。

To clarify matters:
更清楚一点讲：
* 您不能对一个完全相同的目标进行多次处罚或禁言。对于不同的处罚类型，一个目标的含义是：
  * 一个UUID（对于玩家处罚）
  * 一个IP地址（对于IP处罚）
  * 一个UUID和一个IP地址的组合（对于组合式处罚）
* 如果有两条处罚记录，分别对相同的UUID、但是不同的IP地址生效，它们的处罚目标就是不一样的，因此它们可以同时作为生效的处罚存在。

### 执行与撤销组合处罚

大多数情况下，组合式处罚执行的过程应当是直观切友好的。不过这种友好的高等界面背后，是复杂的具体机制。因此最好在这里记录这些技术细节。

执行处罚的过程很简单。目标用户的UUID和IP地址这个组合会被处罚。

撤销处罚的过程会尽可能有效地确定哪些处罚记录应当被撤销。
* 第一个满足以下条件的处罚记录会被撤销：
  * 如果您解封一个玩家，插件会尝试解封这个玩家的UUID。如果没有成功，插件会尝试撤销所有与该玩家UUID匹配的组合式封禁，并不会考虑尚未过期的组合式封禁中的IP地址。
  * 如果您解封一个IP地址，插件会尝试解封这个IP地址。如果没有成功，插件会尝试撤销所有与该IP地址匹配的组合式封禁，并不会考虑尚未过期的组合式封禁中的UUID。
  * 换句话来讲，LibertyBans会尝试找到所有您在使用`/unban Player1`或`/unban 127.0.0.1`时想表示的处罚记录 - 无论是对一个常规的目标还是一个组合的目标。
  * 注意这个过程是通过一个数据库查询操作完成的。
* 无论您是否启用`composite-by-default`选项，以上操作都会发生。

## 总结

请确保您在使用组合式处罚之前理解它的机制。
